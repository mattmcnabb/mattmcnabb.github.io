---
layout: post
title: The O365 Admin Powershell Module - Part 1
categories: [Office 365, Powershell]
author: Matt McNabb
comments: true
---

[Connect]: https://technet.microsoft.com/en-us/library/jj984289(v=exchg.150).aspx
[Profile]: http://blogs.technet.com/b/heyscriptingguy/archive/2013/01/04/understanding-and-using-powershell-profiles.aspx
[Github]: https://github.com/mattmcnabb/O365Admin

### Connecting to Office 365 Services
If you're already responsible for managing your company's Office 365 tenant, then you know that sometimes you need to employ Powershell to get things done. The Office 365 Admin Center is pretty capable of handling your basic admin tasks and it's getting better all the time, but sometimes you need to do something outside of the box or manage settings in bulk. Powershell is the way to get it done.

Exchange Online has the most manageability of all the Office 365 products and since it's built on Exchange it is fully exposed to Powershell management. The instructions for connecting to Exchange Online in Powershell can be found [here] [Connect]. This process is similar to how Exchange would be managed in an on-premise installation. You initialize a remote session to an Exchange server, pass credentials, and then import the commands from that session into your environment.

{% highlight Powershell %}
$Credential = Get-Credential
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell -Credential $Credential -Authentication Basic -AllowRedirection
Import-PSSession $Session
{% endhighlight %}

That's quite a bit of typing, and this stinks if you have to come in every morning and type this in. Not to mention that this only connects you to Exchange Online. If you want to manage users or licensing you'll need to connect to Azure Active Directory, and there are more commands still if you want to connect to Skype (formerly Lync) or Sharepoint Online.

{% highlight Powershell %}
### Connect to Azure Active Directory to manage users, groups and licensing
Connect-MsolService -Credential $Credential

### Connect to Sharepoint Online for domain psescape.onmicrosoft.com
Connect-SpoService -Credential $Credential -Url https://psescape-admin.sharepoint.com

### Connect to Lync Online
$Session = New-CsOnlineSession -Credential $Credential
Import-PSSession $Session
{% endhighlight %}

The next logical step for an admin who needs to manage Office 365 tenants regularly is to add all these commands to your Powershell profile. A powershell [profile script] [Profile] is simply a script that is launched each time you launch Powershell. This provides a way configure your shell environment and can speed up your day-to-day tasks. But why should every admin who manages Office 365 perform the same repetitive tasks and re-create the same profile scripts that every other Office 365 admin has created?

Enter the [Office 365 Admin module] [Github]. With this module you can quickly and easily connect to Exchange Online and all other Office 365 services. Instead of all the commands above, you can now simply type:

{% highlight Powershell %}
Connect-O365 -Services AzureActiveDirectory, Exchange, Sharepoint, Skype -Credential $Credential
{% endhighlight %}

You can pick and choose any of the services you would like to connect to, and the service names also support tab-completion for ease of use.